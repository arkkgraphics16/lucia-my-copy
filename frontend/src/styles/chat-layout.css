/* lucia-secure/frontend/src/styles/chat-layout.css */

/* Content width and sidebar variables */
:root {
  --content-w: 820px;
  --sidebar-width: 280px;
}

/* ================== DESKTOP/TABLET CENTERING ================== */

/* MODIFIED: Only center user bubbles and limit banners, not assistant bubbles */
.thread {
  max-width: var(--content-w);
  margin-left: auto;
  margin-right: auto;
}

/* NEW: Allow assistant bubbles to break out and use full available space */
.bubble.assistant {
  width: calc(100vw - var(--sidebar-width) - 48px) !important; /* Full width minus sidebar and padding */
  max-width: none !important;
  margin-left: calc(-1 * max(12px, ((100vw - var(--sidebar-width)) - var(--content-w)) / 2)) !important;
  margin-right: calc(-1 * max(12px, ((100vw - var(--sidebar-width)) - var(--content-w)) / 2)) !important;
}

/* Keep user bubbles within content width and right-aligned */
.bubble.user {
  max-width: 70%;
  margin-left: auto;
}

.limit-banner {
  max-width: var(--content-w);
  margin-left: auto;
  margin-right: auto;
}

/* Desktop/tablet: center the Composer within the available space (viewport - sidebar) */
@media (min-width: 820px) {
  .composer-row {
    left: calc(
      var(--sidebar-width) + max(12px,
        ((100vw - var(--sidebar-width)) - var(--content-w)) / 2
      )
    );
    right: calc(
      max(12px,
        ((100vw - var(--sidebar-width)) - var(--content-w)) / 2
      )
    );
  }
}

/* Bottom usage indicator chip (desktop only) */
.usage-indicator.bottom-chip {
  max-width: var(--content-w);
  margin: 8px auto 0 auto;
}

/* ================== TABLET BREAKPOINT ================== */
@media (max-width: 1024px) and (min-width: 769px) {
  :root {
    --sidebar-width: 240px;
  }
  
  .thread,
  .limit-banner {
    max-width: var(--content-w);
    padding-left: 20px;
    padding-right: 20px;
  }
  
  /* Adjust assistant bubble width for tablet */
  .bubble.assistant {
    width: calc(100vw - var(--sidebar-width) - 40px) !important;
    margin-left: calc(-1 * max(20px, ((100vw - var(--sidebar-width)) - var(--content-w)) / 2)) !important;
    margin-right: calc(-1 * max(20px, ((100vw - var(--sidebar-width)) - var(--content-w)) / 2)) !important;
  }
}

/* ================== MOBILE BREAKPOINT ================== */
@media (max-width: 768px) {
  /* Full width layout on mobile */
  .thread,
  .limit-banner {
    max-width: 100%;
    padding-left: 12px;
    padding-right: 12px;
  }
  
  /* Mobile: Assistant bubbles use full screen width */
  .bubble.assistant {
    width: calc(100vw - 24px) !important;
    margin-left: -12px !important;
    margin-right: -12px !important;
  }
  
  /* Hide bottom usage chip on mobile */
  .usage-indicator.bottom-chip {
    display: none;
  }
  
  /* Composer spans full width on mobile */
  .composer-row {
    left: auto;
    right: auto;
    position: relative;
    max-width: 100%;
  }
  
  /* Adjust thread padding for mobile composer */
  .thread {
    padding-bottom: calc(var(--composer-h, 72px) + 16px);
  }
}

/* ================== RESPONSIVE CONTENT WIDTHS ================== */

/* Very wide screens - increase content width slightly */
@media (min-width: 1400px) {
  :root {
    --content-w: 900px;
  }
}

/* Medium screens - reduce content width */
@media (max-width: 1200px) and (min-width: 821px) {
  :root {
    --content-w: 760px;
  }
}

/* Smaller tablets - further reduce content width */
@media (max-width: 1024px) and (min-width: 769px) {
  :root {
    --content-w: 680px;
  }
}

/* ================== SAFE AREA HANDLING ================== */

/* Handle notch and safe areas on mobile devices */
@media (max-width: 768px) {
  .thread {
    padding-left: max(12px, env(safe-area-inset-left));
    padding-right: max(12px, env(safe-area-inset-right));
  }
  
  .composer-row {
    padding-left: max(12px, env(safe-area-inset-left));
    padding-right: max(12px, env(safe-area-inset-right));
  }
}

/* ================== ACCESSIBILITY ================== */

/* Ensure adequate spacing for touch targets on mobile */
@media (max-width: 768px) {
  .bubble {
    margin-bottom: 12px;
  }
  
  .bubble:last-child {
    margin-bottom: 0;
  }
}